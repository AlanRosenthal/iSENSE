<?php

class MDB {
	
	var $c;
	var $db;
	var $col;
	
	function MDB($database, $collection = "data", $hostname = "localhost", $port = 27017, $username = null, $password = null) {
		
		$auth = "";
		if($username != null && $password != null) {
			$auth = "{$username}:{$password}@";
		}
		
		$con_string = "mongodb://{$auth}{$hostname}:{$port}";
		
		try {
		$this->c = new Mongo($con_string);
		$this->db = $this->c->selectDB($database);
		$this->col = $this->db->selectCollection($collection);
    } catch (MongoConnectionException $e) {
        $err = "Mongo Isn't Running";
    }
	}
	
	function selectCollection($col) {
		$this->col = $this->db->selectCollection($col);
	}
	
	function insert($collection, $data) {
		$this->selectCollection($collection);
		return $this->col->insert($data);
	}
	
	function find($collection, $conds = array(), $cols = array()) {
		$this->selectCollection($collection);
		
		$results = $this->col->find($conds, $cols);
		
		$output = array();
		foreach($results as $result) {
			$output[] = $result;
		}
		
		return $output;
	}
	
}

$mdb = new MDB(MDB_DATABASE);

ini_set('mongo.native_long', 1);
ini_set('mongo.native_long', 1);
?>